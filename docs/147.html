<html>
<head>
<title>How to detect the Microsoft SMBGhost vulnerability with Pentest-Tools.com | Pentest-Tools.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何用Pentest-Tools.com检测微软SMBGhost漏洞| Pentest-Tools.com</h1>
<blockquote>原文：<a href="https://pentest-tools.com/blog/how-to-detect-microsoft-smbghost-vulnerability#2022-07-07T10:59:24.000Z">https://pentest-tools.com/blog/how-to-detect-microsoft-smbghost-vulnerability#2022-07-07T10:59:24.000Z</a></blockquote><div><div class="prose prose-headings:break-words prose-img:rounded-md prose-img:ring-1 prose-img:ring-dark-blue-200 prose-img:ring-opacity-30 prose-code:break-words prose-headings:[scroll-margin-top:120px] xl:prose-lg xl:prose-headings:w-[628px] xl:prose-p:w-[628px]">
            
              
                
                  <p>在过去的几周里，在微软服务器消息块3.1.1 (SMBv3)中发现的一个严重的RCE漏洞一直让微软用户和安全社区保持警觉。</p><p>为了帮助我们的客户更好地检测他们的Windows主机是否受到严重的SMBGhost漏洞的影响，<strong>我们在Pentest-Tools.com上开发并添加了<a href="https://pentest-tools.com/network-vulnerability-scanning/network-security-scanner-online-openvas">一个新的专用扫描器</a>。</strong></p><p>正如你现在可能知道的，我们并没有为每个突然出现的漏洞创造新的工具。这是促使我们构建新扫描仪并扩展平台的原因。</p><p>这个漏洞特别严重，因为它是<strong>“可蠕虫化的</strong>”，并且有可能通过内部网络从一个易受攻击的系统快速传播到另一个系统。更有甚者<strong>，该漏洞让人想起导致WannaCry爆发的<a target="_blank" rel="external nofollow noopener noreferrer" href="https://research.checkpoint.com/2017/eternalblue-everything-know/">永恒蓝色漏洞</a> </strong>。</p><h2 id="1-what-we-know-about-the-smbghost-vulnerability"><strong> 1。我们对SMBGhost漏洞的了解</strong></h2><p>2020年3月10日，在其月度补丁星期二期间，微软泄露了一个严重的SMB漏洞的信息，该漏洞是由安全研究人员意外发现的。</p><p/><p>被跟踪为<a target="_blank" rel="external nofollow noopener noreferrer" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-0796"> <strong> CVE-2020-0796 </strong> </a>的RCE漏洞存在于微软服务器消息块3.0 (SMBv3)处理某些请求的方式中。</p><p>微软SMB v3.1.1是一个主要用于新操作系统的协议，这意味着它会影响运行以下操作系统的机器:<strong> Windows 10 </strong>(版本1903和1909)和<strong> Windows Server </strong> (1903和1909)。</p><p>该漏洞不会暴露Windows 7、8或8.1等旧版本，因为它们不支持SMBv3.1.1压缩。</p><p>为了利用这一漏洞，一名未经认证的攻击者向目标SMBv3服务器发送特制的数据包，并“说服用户连接到它”，微软在T2安全顾问更新中表示。</p><p>成功利用该漏洞可能允许黑客在目标SMB服务器或SMB客户端上执行代码。然而，在我们发表这篇文章之前，一个有效的RCE漏洞还没有被发现。考虑到Windows内核中实现的现有安全措施，创建一个似乎很困难。</p><p>对该漏洞的深入<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.mcafee.com/blogs/other-blogs/mcafee-labs/smbghost-analysis-of-cve-2020-0796/">技术分析</a>得出结论，某些SMB数据包可能会导致缓冲区溢出，并通过获得BSOD(蓝屏死机)消息使Windows主机崩溃。</p><p>创建拒绝服务攻击(BSOD)的<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/maxpl0it/Unauthenticated-CVE-2020-0796-PoC"> <strong>概念验证</strong> </a>已经<strong>可用，</strong>包括来自安全研究人员的简短<a target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/kryptoslogic/status/1238057276738592768">演示视频</a>。</p><p>我们使用该工具的目的是使发现您的Windows计算机是否存在暴露于SMBGhost漏洞的风险变得容易。</p><p>我们开发的<a href="https://pentest-tools.com/network-vulnerability-scanning/network-security-scanner-online-openvas"> </a> <a href="https://pentest-tools.com/network-vulnerability-scanning/network-security-scanner-online-openvas"> <strong> SMBGhost扫描器</strong></a><strong>检查目标主机的SMB版本</strong>以识别<strong>SMB服务是否启用了压缩</strong>。它首先扫描Windows文件共享服务通常使用的TCP 445端口。</p><p>扫描仪还允许您<strong>检测<em>不</em>易受攻击</strong>的Windows主机(例如，它们不支持SMBv3.1.1或它们禁用了SMBv3压缩)。</p><p>为了验证这些设置，我们的工具尝试启动与目标服务器的SMB协商，提出SMB版本3.1.1方言:<strong> </strong> <code>0x0311</code>和启用压缩的<code>NegotiateContextCount: 2</code>。如果SMB响应数据包包含建议的设置，我们的扫描器会声明目标可能易受SMBGhost攻击。</p><p><strong>下面是SMBGhost扫描的示例报告:</strong></p><p><img src="../Images/0c2809b0954d753edc6801dce0cd1f12.png" alt="sample report of a SMBGhost scan" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvaG93LXRvLWRldGVjdC1taWNyb3NvZnQtc21iZ2hvc3QtdnVsbmVyYWJpbGl0eS9zbWJnaG9zdC1jdmUtMjAyMC0wNzk2LnBuZw==?s=b2ca4da44d21c313204a9121f098249d"/></p><h2 id="3-secure-your-windows-hosts-with-this-update"><strong> 3。使用此更新保护您的Windows主机</strong></h2><p>微软已经发布了针对SMBv3协议中发现的漏洞的<strong>安全补丁</strong>，称为<a target="_blank" rel="external nofollow noopener noreferrer" href="https://support.microsoft.com/en-us/help/4551762/windows-10-update-kb4551762"> KB4551762 </a>，用于Windows 10 1909版本和Windows 10 1903版本的更新。我们建议尽快应用这些软件更新！</p><p>在一份安全公告中，该公司还提供了一些<a target="_blank" rel="external nofollow noopener noreferrer" href="https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/ADV200005"> <strong>变通方案</strong> </a> <strong>来禁用SMBv3压缩</strong>或<strong>阻塞TCP端口445 </strong>。</p><h2 id="4-discover-vulnerable-windows-hosts-with-the-smbghost-scanner"><strong> 4。使用SMBGhost扫描器发现易受攻击的Windows主机</strong></h2><p>我们创建了这个<strong>扫描器</strong>来帮助您轻松扫描Windows主机并检测这个RCE漏洞。无论您是系统管理员还是安全顾问，您都可以<a href="https://pentest-tools.com/network-vulnerability-scanning/network-security-scanner-online-openvas"> <strong>使用该扫描器</strong> </a>执行简单的安全测试<strong>并检测您的Windows机器是否受到SMBGhost漏洞的影响。</strong></p>

                

                
              
            
          </div>
        </div>    
</body>
</html>