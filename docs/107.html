<html>
<head>
<title>Essential HTTP Headers for securing your web server | Pentest-Tools.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>保护您的 web 服务器的基本 HTTP 头| Pentest-Tools.com</h1>
<blockquote>原文：<a href="https://pentest-tools.com/blog/essential-http-security-headers#2023-02-21T16:05:07.000Z">https://pentest-tools.com/blog/essential-http-security-headers#2023-02-21T16:05:07.000Z</a></blockquote><div><div class="prose prose-headings:break-words prose-img:rounded-md prose-img:ring-1 prose-img:ring-dark-blue-200 prose-img:ring-opacity-30 prose-code:break-words prose-headings:[scroll-margin-top:120px] xl:prose-lg xl:prose-headings:w-[628px] xl:prose-p:w-[628px]">
            
              
                
                  <p>在本文中，我们讨论最重要的 HTTP 头，您应该在您的<a target="_blank" href="https://pentest-tools.com/website-vulnerability-scanning/website-scanner"> web 服务器</a>上配置这些头，以提高其安全性。</p><p>我们将了解每个报头的作用，以及利用其错误配置可以实施哪些攻击。</p><p>下面是我们将要讨论的有趣的 HTTP 头的类型:</p><p>作为 HTTP 协议的一部分，客户端和 web 服务器使用 HTTP 头来共享信息。当我们在浏览器的地址栏中输入一个 URL 或点击任何链接时，web 浏览器会发送一个包含客户机头的 HTTP 请求，而 HTTP 响应包含服务器头。使用我们的<a href="https://pentest-tools.com/exploit-helpers/http-request-logger"> HTTP 请求记录器，了解如何<a href="https://pentest-tools.com/blog/how-to-simulate-phishing-attacks-with-http-request-logger">更快地模拟网络钓鱼攻击</a>。</a></p><p>下面是这样一个调用 Google 的网页时的 HTTP 请求-响应对:</p><p>有几十个 HTTP 头，解释它们不是本文的目的。不过，你可以在 Mozilla 的 HTTP Headers  页面的<a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers"> <strong>找到一个很好的参考和每个头的详细信息。</strong></a></p><p>我们将讨论具有安全影响的 HTTP 服务器头。</p><h3 id="1-http-strict-transport-security-hsts"><strong> 1。HTTP 严格的传输安全(HSTS) </strong></h3><p>HTTP 严格传输安全指示浏览器只能通过 HTTPS 访问 web 服务器。一旦在服务器上进行了配置，服务器就会在响应中以<code>Strict-Transport-Security</code>的形式发送报头。收到这个报头后，浏览器将只通过 HTTPS 向该服务器发送所有请求。HSTS 报头有 3 个指令:</p><p><img src="../Images/ee83cc5607777d5998273dd10b740d51.png" alt="http header results" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjIzLnBuZw==?s=bdfc9f75d1ef518021a083109a2bd96d"/></p><p><img src="../Images/70bdd81dd970f0dd02bbe69ca436cd9e.png" alt="http header results displayed" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjMyLnBuZw==?s=d77f869f95b3b5df555842428e6daa9c"/></p><ul><li><p><strong> IncludeSubDomains </strong>:这也适用于对网站子域的控制。</p></li><li><p><strong>预加载</strong>:预加载列表是硬编码到谷歌 Chrome 浏览器中的网站列表，这些网站只能通过 HTTPS 进行通信。网站的所有者可以提交其 URL 以包含在预加载列表中。该列表由谷歌维护，但其他浏览器也使用它。预载列表可在<a target="_blank" rel="external nofollow noopener noreferrer" href="https://chromium.googlesource.com/chromium/src/+/master/net/http/transport_security_state_static.json">这里</a>找到:</p></li></ul><p><strong>攻击场景</strong></p><p>如果没有启用 HSTS，对手可以进行中间人攻击，并从用户的 web 会话中窃取敏感信息。想象一个场景，受害者连接到一个开放的 Wi-Fi，而这个 Wi-Fi 实际上是在攻击者的控制之下。通过 HTTP 访问网站将允许攻击者拦截请求并读取敏感信息。(该网站位于 HTTPS，但用户通过 HTTP 访问，后来被重定向到 HTTPS)。如果同一个用户早些时候访问了该网站，浏览器中记录的 HSTS 详细信息会导致连接自动通过 HTTPS 进行。</p><h3 id="2-content-security-policy"><strong> 2。内容安全政策</strong></h3><p>内容安全策略用于指示浏览器仅加载策略中定义的允许内容。这使用了白名单方法，告诉浏览器在哪里加载图像、脚本、CSS、小程序等。如果实施得当，该策略可以防止利用<a target="_blank" rel="noopener noreferrer" href="https://pentest-tools.com/website-vulnerability-scanning/xss-scanner-online">跨站点脚本(XSS) </a>、点击劫持和 HTML 注入攻击。</p><p>头的名字是<code>Content-Security-Policy</code>，它的值可以用以下指令定义:<code>default-src</code>、<code>script-src, media-src</code>、<code>img-src</code>。它们指定了浏览器应该从何处加载这些类型的资源(脚本、媒体等)。</p><p>以下是一个设置示例:</p><div class="content-highlight"><pre class="code-block"><code>Content-Security-Policy: default-src 'self'; media-src media123.com media321.com; script-src script.com; img-src *;</code></pre></div><p>这被浏览器解释为:</p><p><strong>例题</strong></p><p><strong>为 dropbox.com 正确设置内容-安全-策略</strong>标题:</p><p><img src="../Images/a8b481e103b6b2a836aaa24a46e81efd.png" alt="content security policy header" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjM3LnBuZw==?s=bdf37a68bb83888a36e12d9d6aed355d"/> <strong>内容-安全-策略</strong>没有为 apple.com 设置标题:</p><p><img src="../Images/c4ca43c92b91e01f91b39f769bd41817.png" alt="Content security policy header apple.com" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjM4LnBuZw==?s=6336da2a6b0812ab920a52fdae9e5133"/>关于内容安全政策的更多信息可以在<a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP"> Mozilla 网站</a>上找到。</p><h3 id="3-access-control-allow-origin"><strong> 3。访问控制允许来源</strong></h3><p><code>Access-Control-Allow-Origin</code>是 CORS ( <a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">跨源资源共享</a>)头。这个头允许定义的第三方访问给定的资源。这个头是由<a target="_blank" rel="external nofollow noopener noreferrer" href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">同源策略</a>造成的限制的一个变通方法，该策略不允许两个不同的源读取彼此的数据。</p><p>例如，如果<em>站点 ABC </em>想要访问<em>站点 XYZ </em>的资源，<em>站点 XYZ </em>将使用带有<em>站点 ABC </em>地址的<code>Access-Control-Allow-Origin</code>报头进行响应。通过这种方式，<em>网站 XYZ </em>告诉浏览器谁被允许访问其内容:</p><div class="content-highlight"><pre class="code-block"><code>Access-Control-Allow-Origin: SiteABC.com</code></pre></div><p><strong>攻击场景</strong></p><p>如果<code>Access-Control-Allow-Origin</code>配置薄弱，攻击者可以通过使用另一个第三方网站从目标网站读取数据。许多开发人员在标题中使用通配符<code>Access-Control-Allow-Origin</code>，允许任何网站从其网站读取数据。</p><h3 id="4-set-cookie"><strong> 4。设置 Cookie </strong></h3><p>应用程序设置的 cookie 值由服务器在<code>Set-Cookie</code>头中发送。收到这个头之后，浏览器将在<code>Cookie</code>头中发送带有每个 HTTP 请求的 cookies。</p><p>HTTP cookies 通常包含敏感信息(尤其是会话 cookie ),需要防止未经授权的访问。</p><p>可以设置以下属性来保护 cookies:</p><ul><li><p><code>Secure</code>:设置了此属性的 cookie 将只通过 HTTPS 发送，而不会通过明文 HTTP 协议(容易被窃听)发送。</p></li><li><p><code>HTTPOnly</code>:浏览器不允许 JavaScript 代码访问设置了该属性的 cookies 的内容。这有助于减少通过<a target="_blank" rel="noopener noreferrer" href="https://pentest-tools.com/website-vulnerability-scanning/xss-scanner-online"> XSS 攻击</a>的会话劫持。</p></li></ul><p><strong>例题</strong></p><p>dropbox.com 的 Cookie 属性<code>HTTPOnly</code>和<code>Secure</code>设置正确:</p><p><img src="../Images/70bdd81dd970f0dd02bbe69ca436cd9e.png" alt="cookie attributes set for dropbox.com" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjMyLnBuZw==?s=d77f869f95b3b5df555842428e6daa9c"/>没有为 boeing.com 设置 Cookie 安全属性:</p><h2 id="5-x-frameoptions"><strong> 5。x 帧选项</strong></h2><p>这个标题通过禁止浏览器在一个<em> iframe </em>元素中加载页面来保护用户免受<a target="_blank" rel="external nofollow noopener noreferrer" href="https://owasp.org/www-community/attacks/Clickjacking">点击劫持攻击</a>。<code>X-FrameOptions</code>有 3 个指令:</p><p><img src="../Images/5b7a771fc54543d1fcd6b2b3a245e253.png" alt="github page x-frame options deny" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjE0LnBuZw==?s=59f86722f42cc15d29f464360bad0c9a"/></p><p><img src="../Images/423fe7a827381d93e6b5c585655667ae.png" alt="linkedin page X-Frame-Options same-origin" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjE1LnBuZw==?s=10d7ccc378441df85ceb5394e6bacc74"/></p><p><strong>攻击场景</strong></p><p>对手可能会诱骗用户访问恶意网站，该网站会将目标应用程序加载到不可见的 iframe 中。当用户点击恶意应用程序(例如基于网络的游戏)，点击将被“窃取”并发送到目标应用程序(点击劫持)。因此，用户将在未经其同意的情况下点击合法的应用程序，这可能会导致执行一些不必要的操作(例如删除账户等)。</p><p><strong>示例</strong></p><p><strong> X-Frame-Options </strong>标头已正确实施，可拒绝 dropbox.com 的帧加载:</p><p><img src="../Images/10e267f5f5da4e9a46e0684a090154ac.png" alt="x frame options header " loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjE2LnBuZw==?s=de3a3cd2e0f87662a7ab9e0b5f3ffc72"/></p><p><strong> X-Frame-Options </strong> header 未在 ibm.com 上实现:</p><p><img src="../Images/4ccf106a0c0d0b1a9682ca9a6ff857f9.png" alt="X-Frame-Options header not implemented ibm page" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjE3LnBuZw==?s=7a8c1947d858a63b05aa5a225fd57295"/></p><h3 id="6-x-xss-protection"><strong> 6。X-XSS 保护</strong></h3><p>这个头被设计用来防止<a rel="noopener noreferrer" href="https://pentest-tools.com/blog/xss-attacks-practical-scenarios">跨站点脚本攻击</a>。它与现代浏览器使用的 XSS 过滤器一起工作，它有 3 种模式:</p><ul><li><p><strong>X-XSS-保护:0；</strong>–值 0 将禁用 XSS 过滤器</p></li><li><p><strong>X-XSS-保护:1；</strong>–值 1 将启用过滤器，在检测到 XSS 攻击的情况下，浏览器将净化页面内容以阻止脚本执行。</p></li><li><p><strong>X-XSS-保护:1；mode = block</strong>–如果检测到 XSS 攻击，与 block 模式一起使用的值 1 将阻止页面的呈现。</p></li></ul><p><strong>例题</strong></p><p><strong>X-XSS-保护</strong>标题在 linkedin.com 上正确实现:</p><p><img src="../Images/062955acdef73d70c103d4e099971045.png" alt="X-XSS-Protection header implementation linkedin page" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjEwLnBuZw==?s=ad403093f9179ae741228fa1695c4936"/></p><p>instagram.com 上的<strong> X-XSS 保护</strong>标题丢失:</p><p><img src="../Images/ab6cc28f1505f88a6c8c2a63248bd6f9.png" alt="X-XSS-Protection header missing on instagram page" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjExLnBuZw==?s=d5d7eb1983987a9083f6c59e6b7bdd18"/></p><h3 id="7-x-content-type-options"><strong> 7。x-内容-类型-选项</strong></h3><p>此响应标头用于防止 MIME 嗅探漏洞。那么什么是哑剧嗅探呢？MIME 嗅探是 web 浏览器的一项功能，用于检查所提供文件的内容。它的工作原理如下:</p><ol start="1"><li><p>网络浏览器请求一个文件。服务器发送一个设置了 HTTP 头<em>内容类型</em>的文件。</p></li><li><p>网络浏览器“嗅探”该文件的内容，以确定文件格式。</p></li><li><p>分析完成后，浏览器会将其结果与服务器发送的结果进行比较。如果不匹配，浏览器将使用已识别的格式。</p></li></ol><p>这可能会导致安全漏洞。怎么会？</p><p><strong>攻击场景</strong></p><ol start="1"><li><p>应用程序允许用户上传图像文件并验证其扩展名</p></li><li><p>用户上传扩展名为 jpg 或 png 的图像文件，但该文件也包含恶意 HTML 代码</p></li><li><p>浏览器使用包含代码并在浏览器中执行的 HTML 来呈现文件</p></li></ol><p>通过将头文件<code>X-Content-Type-Options</code>设置为<strong> nosniff </strong>，浏览器将不再“嗅探”接收到的文件内容，而是使用来自<em> Content-Type </em>头文件的值。这个头是专门针对 IE 和 Chrome 浏览器的。</p><p>该报头可以与另外两个报头一起使用，以增强安全性。</p><ul><li><p><strong> Content-Disposition </strong>:强制浏览器显示下载 pentest.html 文件的弹出窗口。</p><div class="content-highlight"><pre class="code-block"><code>Content-Disposition: attachment; filename=pentest.html</code></pre></div></li><li><p><strong> X-Download-Options </strong>:当这个头设置为<em> noopen </em>时，用户在打开文件前会被强制先保存在本地，而不是直接在浏览器中打开文件</p></li></ul><p><strong>例题</strong></p><p><strong>为 linkedin.com 正确实现 X-Content-Type-Options </strong>标题:</p><p><img src="../Images/ce70f41c4d6d22bbafe847dbf7c9cb44.png" alt="X-Content-Type-Options header implemented correctly for linkedin page" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjI4LnBuZw==?s=da66a3a34331674cf35a8ea5d2d14eec"/></p><p><strong>X-Content-Type-Options</strong>header 未在 instagram.com 上实现:</p><p><img src="../Images/4ce9ee61ccc02327027272ec16019813.png" alt="X-Content-Type-Options header not implemented on Instagram page" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjI5LnBuZw==?s=b2e4aad98a5bcea1f9dabc159dd9f5ff"/></p><h3 id="1-server"><strong> 1。服务器:</strong></h3><p>这个头包含关于后端服务器的信息(类型和版本)。例如，下面的截图显示运行耐克网页的网络服务器是<code>Jetty</code>，版本是<code>9.4.8.v20171121</code>。</p><p><img src="../Images/419769fc57e86ccf1e5eb70ed212db98.png" alt="webserver Jetty on Nike's page" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjUucG5n?s=fa9c8259e47a3e068e1ee393b859d069"/></p><p>具备这方面知识的对手可能会寻找针对 Jetty 9 . 4 . 8 版本的漏洞。这些信息可以在公共数据库中找到，例如:</p><p>你只需要搜索具体的产品和版本。以下是影响 Jetty web 服务器的漏洞:</p><p><a href="https://nvd.nist.gov/vuln/search/results?form_type=Basic&amp;results_type=overview&amp;query=jetty&amp;search_type=all" rel="external nofollow noopener noreferrer">https://nvd.nist.gov/vuln/search/results?form_type=Basic&amp;结果 _ 类型=概述&amp;查询=突堤&amp;搜索 _ 类型=全部</a></p><p><strong>好例子</strong></p><p>可以通过重新配置 web 服务器来屏蔽服务器信息。举个例子，Linkedin 的网站上有一个很好的配置(服务器名被修改为“Play”):</p><p><img src="../Images/9d4a37e78e1b7cf36204bc3ab4c15ed6.png" alt="server information linkedin page" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjQucG5n?s=c7328de91ef76f870811d8b3fb5e8f90"/></p><h3 id="2-x-powered-by"><strong> 2。x-供电人:</strong></h3><p>它包含 web 应用程序中使用的 web 框架或编程语言的详细信息。例如，https://msc.mercedes-benz.com<a href="https://msc.mercedes-benz.com" rel="external nofollow noopener noreferrer">的 web 应用程序是用<code>PHP 7.1.22</code>构建的，由<code>Plesk</code>托管。</a></p><p><img src="../Images/5b02044a6df76e94d70366dc289d081e.png" alt="X-Powered-By PHP and hosted by PleskLin" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlci14LXBvd2VyZWQtYnkucG5n?s=ccfd591572d34cf91b7b97c31c2f8293"/></p><h3 id="3-x-aspnet-version"><strong> 3。x-AspNet-版本:</strong></h3><p>顾名思义，它显示了 ASP。NET 框架。这些信息可以帮助对手根据框架及其版本微调其攻击。</p><p>以下是来自 http://demo.testfire.net<a href="http://demo.testfire.net" rel="external nofollow noopener noreferrer">服务器</a>的标题示例</p><p><img src="../Images/46a57ed94bdfb1419802df90fb54b6ca.png" alt="X-AspNet-Version header example" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZXNzZW50aWFsLWh0dHAtc2VjdXJpdHktaGVhZGVycy9odHRwLWhlYWRlcjYucG5n?s=dd127ad01b6d7519486aaff68241ac94"/></p><h4><strong>结论</strong></h4><p>可以在服务器上配置 HTTP 头，以增强 web 应用程序的整体安全性。这些标头不会使应用程序更加安全，但它们可以防止利用应用程序的潜在漏洞。</p>

                

                
              
            
          </div>
        </div>    
</body>
</html>