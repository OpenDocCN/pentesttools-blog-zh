<html>
<head>
<title>Phishing a company through a 7-Zip misconfiguration | Pentest-Tools.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>通过一个 7-Zip 错误配置钓鱼一家公司| Pentest-Tools.com</h1>
<blockquote>原文：<a href="https://pentest-tools.com/blog/phishing-7-zip-misconfiguration#2023-01-20T10:58:02.000Z">https://pentest-tools.com/blog/phishing-7-zip-misconfiguration#2023-01-20T10:58:02.000Z</a></blockquote><div><div class="prose prose-headings:break-words prose-img:rounded-md prose-img:ring-1 prose-img:ring-dark-blue-200 prose-img:ring-opacity-30 prose-code:break-words prose-headings:[scroll-margin-top:120px] xl:prose-lg xl:prose-headings:w-[628px] xl:prose-p:w-[628px]">
            
              
                
                  <p>阅读关于网络钓鱼的文章有时会感到乏味，因为许多文章只是重复使用相同的旧场景和防范策略，而没有深入技术细节或提供任何新内容。但是别担心，我们会掩护你的！</p><p>具体来说，我们将介绍攻击者如何利用 7-Zip 中的错误配置来禁用 Web (MOTW)标记，并发起更有效的网络钓鱼攻击。我们还将展示 Sniper Auto-Exploiter 中的客户端攻击特性如何帮助消除在这种情况下手动设置和配置反向 shells 的需要。</p><p>请继续阅读，以便更好地理解这种技术是如何工作的，以及有哪些缓解方案。所以，喝杯咖啡，坐下来，准备扩展你在这些重要的网络安全问题上的知识。</p><h2 id="disclaimer">放弃</h2><p>本材料仅用于教育目的，不得非法复制。<a href="http://hacking-goodies.shop" rel="external nofollow noopener noreferrer"><u>hacking-goodies . shop</u></a>归<a href="http://pentest-tools.com"><u>Pentest-Tools.com</u></a>所有，它允许你测试本文描述的技术。请不要试图重现本材料中描述的任何行为，这些行为不属于受法律合同约束的道德黑客行为。</p><h2 id="why-we-decided-to-write-about-this"><strong>为什么我们决定写这篇文章</strong></h2><p>回到 2022 年 11 月，Pentest-Tools 的创始人艾德里安·富图纳(Adrian Furtuna)，<a target="_blank" href="https://youtu.be/XNOUKFVbxlw" rel="external nofollow noopener noreferrer"> <u>在<a href="https://pentest-tools.com/exploit-helpers/sniper"> <u>狙击中为</u> </a>推出了一个新功能:Auto-Exploiter</u></a>at<a target="_blank" href="http://def.camp" rel="external nofollow noopener noreferrer"><u>DefCamp</u></a>称为<strong>客户端攻击。</strong></p><p>网络钓鱼攻击是一种网络攻击，它使用电子邮件或其他形式的通信来欺骗人们泄露敏感信息，如登录凭据或财务信息。您可能知道，您可以使用 VBA 宏来创建各种类型的恶意攻击，这些攻击可以通过电子邮件或其他方式进行。当用户打开文档或点击链接时，就会执行宏并发起攻击。</p><p>VBA (Visual Basic for Applications)是一种内置于许多 Microsoft Office 应用程序中的编程语言，包括 Excel、Word 和 PowerPoint。它用于创建宏，宏是由用户定义的事件触发的自动操作序列，例如单击按钮或打开文档。</p><p>VBA 用于创建广泛的定制解决方案，包括数据分析工具、重复任务自动化和定制用户界面的创建。然而，恶意行为者也喜欢用它来制造网络钓鱼攻击。</p><p>在很短的一段时间内，微软通过引入网络标记(MOTW)修补了这种类型的攻击。如果文件是从 internet 下载的，此功能会阻止宏运行。</p><h2 id="what-makes-7-zip-such-a-good-phishing-vector">是什么让 7-Zip 成为如此好的网络钓鱼载体</h2><p>您可能知道，7-Zip 是一种广泛使用的文件归档软件，它允许用户将多个文件压缩和打包成一个归档文件。它是开源的，支持多种文件格式，包括它自己的. 7z 格式，以及其他格式，如。zip 和. rar。</p><p>除了文件归档功能，7-Zip 还包括一个名为“7z”的命令行实用程序，可以对归档文件进行各种操作，例如提取文件、将文件添加到归档文件或创建新的归档文件。这个工具允许极大的灵活性和多功能性，使 7-Zip 成为个人和专业使用的有用工具。</p><p>接下来，我们将了解一个简单的 7-Zip 错误配置如何禁用 Office 应用程序(如 Excel、Word 和 PowerPoint)中的 Web 标记，然后您可以在网络钓鱼防范模拟中使用它。</p><h2 id="how-does-this-misconfiguration-arise"><strong>这种错误配置是如何产生的？</strong></h2><p>漏洞本身非常简单明了。简单地说，当你存档一个文件并给它设置密码时，7-Zip 会删除 alert 属性。</p><p>正如您在下面看到的，当您检查从互联网下载的文件的属性时，它会显示一个警告，不允许您运行宏。</p><p><img src="../Images/2aecfc057257edec72c7c848334b8e7b.png" alt="security for a zip file" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvcGhpc2hpbmctNy16aXAtY29uZmlndXJhdGlvbi83LXppcC1maWxlLWRvd25sb2FkZWQucG5n?s=2a47dc56f76fa6c6307140c6ee1cd843"/>如果您勾选<strong>解锁</strong>框，您可以取消它并执行宏。在网络钓鱼环境中，这没有帮助，因为受害者在看到警报时不会进一步手动选中<strong>解锁</strong>框。(大多数用户不知道去哪里做这件事。)</p><p>但是，通过在 7-zip 中存档带有密码的文件，您可以摆脱警报并更秘密地传递它。右击该文件并选择<strong>添加到档案</strong>。</p><p><img src="../Images/f85b1fcea292270a08b51d45994146b2.png" alt="add file to archive" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvcGhpc2hpbmctNy16aXAtY29uZmlndXJhdGlvbi9hcmNoaXZlLXRoZS1maWxlLnBuZw==?s=f7dc8eba2b75a22225d8afe736d9fdbd"/>输入任意密码，然后点击<strong>确定。</strong></p><p>完成这些简单的步骤后，解压文件并再次检查文件属性。</p><p><img src="../Images/29278752b5468752b1fa92bfb2454328.png" alt="unzipe the archive" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvcGhpc2hpbmctNy16aXAtY29uZmlndXJhdGlvbi91bnppcC10aGUtYXJjaGl2ZS5wbmc=?s=2f5edc64a29b1987e437942ccb96f5e5"/>如您所见，MOTW 已被完全擦除，当受害者试图查看文件属性时，它不再出现。</p><h2 id="ok-but-how-can-an-attacker-profit-from-this-scenario"><strong>好吧，但是攻击者如何从这个场景中获利呢？</strong></h2><p>下图解释了这种情况下的步骤</p><p><img src="../Images/ab3768bf557187cdc1cf748b7b21aedc.png" alt="spear phishing" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvcGhpc2hpbmctNy16aXAtY29uZmlndXJhdGlvbi9zcGVhci1waGlzaGluZy5wbmc=?s=5d0bb79c3cf785faed4eb34c36d4fbbe"/></p><p>想象一下下面的场景(我们将这个<a href="https://pentest-tools.com/blog/dmarc-protocol-email-security"> <u> DMARC 错误配置</u> </a>添加到我们的网络钓鱼活动中):您想要内部访问 hacking-goodies.shop，这样您就可以给自己发送一些免费的好东西。</p><p>你通过 OSINT 发现 Steve 是技术部门的新员工，在那里他可以接触到很多机密信息。你还发现该公司使用 name . surname @ hacking-goodies . shop 格式发送员工电子邮件。</p><p>利用收集到的数据，您可以通过伪造邮件和发送恶意文件(显然是出于安全意识的目的)来轻松冒充公司的 CEO。</p><p>在上面的例子中，我们创建了一个适合 Steve 情况的场景，并呈现了一个他被迫下载文件的场景。</p><p>这只是一个简单的例子，但是想象一下高级持续威胁(APT)组织或国家支持的攻击者(SSA)使用这种错误配置以及他们可以从中获得的能力！</p><h2 id="demo-time-phishing-simulation">演示时间:网络钓鱼模拟</h2><p>深入一点，你会弄脏你的手，练习你刚刚学到的东西。</p><p>观看我们的同事<a href="https://pentest-tools.com/blog/authors/stefan-iridon"> <u> Stefan </u> </a>在一个短视频<strong>中演示如何使用<a href="https://pentest-tools.com/exploit-helpers/sniper"> <u>狙击手:自动开发者的</u> </a> <strong>客户端攻击</strong>功能运行该场景。</strong></p><p>在这次网络钓鱼模拟中，没有目标会受到损害。</p>

                

                
              
                
                  <div x-data="{ showVideo: false }" x-on:close.window.stop="showVideo = false" class="not-prose group relative flex items-center justify-center overflow-hidden rounded-xl">
  
  <p aria-hidden="true" class="pointer-events-none absolute inset-0 rounded-xl bg-gray-800 opacity-40">如何在 pentests 中用狙击手自动剥削者模拟客户端攻击</p>
  <p aria-hidden="true" class="absolute h-28 w-28 overflow-hidden rounded-full bg-white bg-opacity-5 shadow-lg ring-1 ring-white ring-opacity-20 transition duration-300 supports-backdrop-filter:backdrop-blur-sm group-hover:scale-110 group-hover:bg-opacity-10 group-hover:ring-opacity-30 sm:h-32 sm:w-32 lg:h-36 lg:w-36"><iframe src="https://www.youtube-nocookie.com/embed/https://www.youtube.com/watch?v=67oihoQVG5g?autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" class="h-full w-full">视频</iframe></p>
  <button type="button" aria-haspopup="true" x-bind:aria-expanded="showVideo ? showVideo : undefined" class="group absolute inset-0 flex w-full items-center justify-center rounded-3xl focus:outline-none" x-on:click="showVideo = true">
    <span class="sr-only">Play video</span>
    <svg class="h-24 w-24 rounded-full ring-offset-4 ring-offset-transparent transition-[box-shadow,transform] duration-300 group-hover:scale-105 group-focus:ring-4 group-focus:ring-white group-focus:ring-opacity-30 sm:h-28 sm:w-28 lg:h-32 lg:w-32" aria-hidden="true" viewbox="0 0 24 24" fill="none">
      <path class="text-white transition-[text-opacity] duration-300" fill="currentColor" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
      <path class="text-secondary-accent-500" fill="currentColor" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
    </svg>
  </button>

  
  

  <template x-if="showVideo">
    
















<template x-teleport="body">
  <div x-data="modal" class="fixed inset-0 z-120 overflow-hidden overflow-y-auto" x-on:keydown.escape.window.prevent.stop="close" x-on:close.window="close" x-show="open">
    <div class="flex h-full justify-center items-center px-4 pt-4 pb-16 sm:p-0">
      <p x-show="open" x-transition.opacity="" aria-hidden="true" class="fixed inset-0 bg-gray-500/75 transition-opacity" x-on:click.stop="close"/>

      
      

      <div x-show="open" x-transition:enter="duration-300 ease-out" x-transition:enter-start="translate-y-4 opacity-0 sm:translate-y-0 sm:scale-95" x-transition:enter-end="translate-y-0 opacity-100 sm:scale-100" x-transition:leave="duration-200 ease-in" x-transition:leave-start="translate-y-0 opacity-100 sm:scale-100" x-transition:leave-end="translate-y-4 opacity-0 sm:translate-y-0 sm:scale-95" role="dialog" aria-modal="true" aria-labelledby="modal-headline" class="transform transition-[opacity,transform] sm:my-8 h-auto sm:w-auto" x-trap.noscroll.inert="open" x-on:transitionend.self.debounce="$focus.first()">
        <div class="relative sm:w-screen sm:max-w-xl lg:max-w-3xl xl:max-w-5xl">
        <h2 id="modal-title" class="sr-only">如何为您的反网络钓鱼宣传活动创建更具吸引力的报告</h2>
        
        <p class="aspect-video overflow-hidden rounded-lg">作为一名有道德的黑客，重要的是不仅要能够有效地识别和缓解安全漏洞，而且要清楚而有说服力地向客户或团队传达您的工作成果。这就是<a href="https://pentest-tools.com/exploit-helpers/"> <u>狙击</u> </a>中新功能派上用场的地方。</p>
      </div>
      </div>
    </div>
  </div>
</template>


  


  </template>
</div>



                

                
              
                
                  <p>使用被动攻击功能，您可以从我们的网站轻松创建攻击处理程序，从而让您在短时间内获得清晰简洁的结果。这可以节省您宝贵的时间和精力，因为它消除了手动设置和配置反向 shells 的需要。</p><h2 id="how-to-create-a-more-compelling-report-for-your-phishing-awareness-campaign">但是这个新功能的好处不仅仅是方便。Sniper 在 handler 过程中提取的<a href="https://pentest-tools.com/exploit-helpers/sniper#artefacts-for-vulnerability-validation"> <u>工件</u> </a>可以提供一个公司暴露于潜在威胁的更加准确和有说服力的图片。通过收集有关系统配置、打开的端口和安装的软件的详细数据，您可以描绘出需要解决的漏洞的全面而令人信服的画面。</h2><p>如何缓解这种类型的网络钓鱼攻击</p><p>网络钓鱼就是注重细节。你可能收到过太明显的钓鱼邮件，不会上当。然而，即使是训练有素的道德黑客也会遇到对手。</p><p>这里有<strong> 3 </strong>个简单的步骤来防止这种攻击场景，您可以窃取并添加到您的 pentest 报告中:</p><h2 id="how-to-mitigate-this-type-of-phishing-attack">1.实施网络分段</h2><p>实施网络分段以限制任何潜在恶意软件或其他恶意代码的传播。这有助于遏制攻击，并使攻击者更难访问关键系统。</p><p>2.培训员工</p><h3 id="1-implement-network-segmentation">就如何识别和报告潜在的安全威胁(如网络钓鱼攻击、可疑电子邮件和恶意链接)向员工提供定期培训。这有助于降低员工成为攻击受害者以及无意中使公司面临风险的风险。</h3><p>3.注意细节</p><h3 id="2-train-employees">注意细节可以缓解几乎所有的网络钓鱼攻击。检查域名产地，MOTW，电子邮件发件人和语法是必不可少的，以防止成为受害者。</h3><p><strong>结论</strong></p><h3 id="3-pay-attention-to-details">这种 7-Zip 错误配置对于黑客来说是一个强大的工具，他们试图绕过 Microsoft Word 关于从互联网下载文件的警告。在网络钓鱼活动中。通过使用 7-Zip 命令行实用程序并战略性地配置存档文件，攻击者可以通过擦除“Web 标记”属性来欺骗受害者下载恶意软件，该属性旨在防止宏在文件从互联网下载时运行。</h3><p>个人和组织需要意识到这种潜在的漏洞，并采取措施保护自己，例如实施适当的防御措施，培训团队成员在下载文件或使用电子邮件时保持谨慎，并练习安全的浏览习惯。</p><h2 id="conclusion">总的来说，<a href="https://pentest-tools.com/exploit-helpers/"> <u>狙击手自动剥削者</u> </a>中新的人工制品提取功能对于任何寻求节省时间的有道德的黑客来说都是有价值的补充。这些功能可以节省您的精力，同时为公司面临的潜在威胁提供更准确、更有说服力的描述。</h2><p>这种 7-Zip 错误配置对于黑客来说是一个强大的工具，他们试图绕过 Microsoft Word 关于从互联网下载文件的警告。在网络钓鱼活动中。通过使用 7-Zip 命令行实用程序并战略性地配置存档文件，攻击者可以通过擦除“Web 标记”属性来欺骗受害者下载恶意软件，该属性旨在防止宏在文件从互联网下载时运行。</p><p>个人和组织需要意识到这种潜在的漏洞，并采取措施保护自己，例如实施适当的防御措施，培训团队成员在下载文件或使用电子邮件时保持谨慎，并练习安全的浏览习惯。</p><p>总的来说，<a href="https://pentest-tools.com/exploit-helpers/"> <u>狙击手自动剥削者</u> </a>中新的人工制品提取功能对于任何寻求节省时间的有道德的黑客来说都是有价值的补充。这些功能可以节省您的精力，同时为公司面临的潜在威胁提供更准确、更有说服力的描述。</p>

                

                
              
            
          </div>
        </div>    
</body>
</html>