<html>
<head>
<title>How to manually detect CVE-2022-21371 in Oracle WebLogic Servers | Pentest-Tools.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何在 Oracle WebLogic Servers | Pentest-Tools.com 中手动检测 CVE-2022-21371</h1>
<blockquote>原文：<a href="https://pentest-tools.com/blog/detect-cve-2022-21371-oracle-weblogic-servers#2023-01-16T23:09:47.000Z">https://pentest-tools.com/blog/detect-cve-2022-21371-oracle-weblogic-servers#2023-01-16T23:09:47.000Z</a></blockquote><div><div class="prose prose-headings:break-words prose-img:rounded-md prose-img:ring-1 prose-img:ring-dark-blue-200 prose-img:ring-opacity-30 prose-code:break-words prose-headings:[scroll-margin-top:120px] xl:prose-lg xl:prose-headings:w-[628px] xl:prose-p:w-[628px]">
            
              
                
                  <p>如果您一直在思考更好的方法来发现系统中的关键漏洞，您并不孤单。</p><p>作为一名安全研究人员，我花了大部分时间来了解它们的根本原因及其对组织的潜在影响，努力帮助其他安全专家有效地传达它们。</p><p>在我详细解释了几个月前在<a href="/blog/detect-exploit-oracle-weblogic-rce-2020"> Oracle WebLogic Server </a>中发现的本地文件包含之后，另一个影响相同 Oracle 技术的漏洞激起了我的好奇心:<strong> CVE-2022-21371 </strong>。</p><p>让我们来分解这个漏洞，并找出如何有效地报告它。</p><h2 id="what-is-oracle-weblogic-server-cve-2022-21371">什么是 Oracle WebLogic Server CVE-2022-21371？</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://nvd.nist.gov/vuln/detail/CVE-2022-21371">CVE-2022-21371</a>(cvss v3 7.5)漏洞使得远程攻击者能够在 Oracle WebLogic Server 内部执行<strong>目录遍历攻击</strong>。</p><p>在我们进入更多的技术细节之前，让我们了解一下什么是 WebLogic server。它是一个 Java 应用服务器，用于开发、集成、部署和管理大规模分布式 web 应用程序、网络应用程序和数据库应用程序。</p><p>它将 Java 的动态功能和 Java 企业标准的安全性引入到广泛的 web 应用程序的开发、集成、部署和管理中。</p><h2 id="how-cve-2022-21371-works">CVE-2022-21371 如何工作</h2><p>该漏洞是由于处理 URL 中的破折号时的<strong>输入验证错误</strong> r 造成的。攻击者可以远程发送一个特制的【HTTP 请求和<strong>读取系统上 web 应用</strong>的部署描述符。这包括应用程序代码和数据、凭证和<a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.oracle.com/cd/E24329_01/web.1211/e21049/weblogic_xml.htm#WBAPP577">部署描述符元素</a>，这使得该漏洞成为 WebLogic Server 的真正威胁。</p><h2 id="vulnerable-oracle-weblogic-versions">易受攻击的 Oracle WebLogic 版本</h2><p>据<a target="_blank" rel="external nofollow noopener noreferrer" href="https://nvd.nist.gov/vuln/detail/CVE-2022-21371"> NIST </a>介绍，此 CVE 影响 Oracle WebLogic Server 版本 12.1.3.0.0、12.2.1.3.0、12.2.1.4.0 和 14.1.1.0.0。</p><h2 id="business-impact-of-cve-2022-21371">CVE 的商业影响-2022-21371</h2><p>如果攻击者能够访问易受攻击的系统，他们可以从 WebLogic 服务器读取敏感数据。例如，坏人可以访问配置文件，甚至进一步检查整个系统的结构和架构。</p><h2 id="how-to-find-targets-vulnerable-to-cve-2022-21371">如何找到易受 CVE 攻击的目标-2022-21371</h2><p>您可以使用 Shodan 搜索引擎和过滤器<strong>产品:“Oracle WebLogic”</strong>在互联网上查找暴露的目标。通过这个查询，我们在撰写本文时找到了 2，398 个结果。</p><p><img src="../Images/794c0a8d6e1ee3f6076a1fda0a790972.png" alt="Oracle WebLogic query results on Shodan" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZGV0ZWN0LWN2ZS0yMDIyLTIxMzcxLW9yYWNsZS13ZWJsb2dpYy1zZXJ2ZXJzL09yYWNsZS1XZWJMb2dpYy1xdWVyeS1yZXN1bHRzLW9uLVNob2Rhbi5wbmc=?s=242136cbc57f7027889e98edd5e8127a"/>另一个选择是尝试 PublicWWW 并搜索<strong> WebLogic 控制台</strong>来找到潜在的易受攻击的目标。当我们发布这个指南时，这个搜索引擎显示了 848 个结果。</p><p><img src="../Images/e174fb3dc08fcde373d3cd9f4153dfc7.png" alt="WebLogic Console search" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZGV0ZWN0LWN2ZS0yMDIyLTIxMzcxLW9yYWNsZS13ZWJsb2dpYy1zZXJ2ZXJzL3dlYmxvZ2ljLWNvbnNvbGUtc2VhcmNoLndlYnA=?s=ca1d94191efd717395af2ecf5a24c964"/></p><h2 id="how-to-manually-detect-cve-2022-21371-in-ethical-hacking-engagements">如何在道德黑客活动中手动检测 CVE-2022-21371</h2><p>想知道如何手动检测这种高危 CVE 吗？</p><p>首先，<strong>使用此特定列表中的一个易受攻击的端点向 Oracle WebLogic 发送 HTTP GET 请求</strong>:</p><p>。//META-INF/清单。MF <br/>。//WEB-INF/web.xml <br/>。//WEB-INF/portlet.xml <br/>。//WEB-INF/weblogic.xml</p><p>curl ' https:// <strong> &lt;主机&gt;</strong>'-请求-目标.//WEB-INF/weblogic.xml "</p><p>由于“.”，curl 的<strong>–request-target</strong>参数是必需的开始的时候。URL 是无效的，因为它不是以'/'开头的，并且，通过阅读 curl 手册，我们发现这个参数允许我们尝试另一个路径。</p><p><img src="../Images/a2685cf6384dc4ef6bacb4fd61f2db2b.png" alt="curl manual page" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZGV0ZWN0LWN2ZS0yMDIyLTIxMzcxLW9yYWNsZS13ZWJsb2dpYy1zZXJ2ZXJzL2N1cmwtbWFudWFsLXBhZ2UucG5n?s=ab1860ae30a09cddcc5b4f35e9749b31"/>此 HTTP GET 请求可让恶意参与者访问 weblogic 服务器内部的<strong> weblogic.xml </strong>文件的内容。</p><p>该文件包含 WebLogic Server 中特定于部署的元素的完整引用。例如，<strong>security-role-assignment</strong>元素声明了 web 应用程序安全角色和 WebLogic Server 中的一个或多个主体之间的映射。<strong> run-as-role-assignment </strong>元素将<strong> web.xml </strong>中的<strong> run-as </strong>角色名(<strong> servlet </strong>元素的子元素)映射到系统中的一个有效用户名。网络罪犯可以利用所有这些信息发起新的攻击，并获得关键基础设施的访问权限。</p><p><img src="../Images/2ae06fb487cafa7b2437a8963232f15e.png" alt="The request and response for the WebLogic payload" loading="lazy" data-original-src="https://pentest-tools.com/blog/img/asset/YXNzZXRzL2NvbnRlbnQvZGV0ZWN0LWN2ZS0yMDIyLTIxMzcxLW9yYWNsZS13ZWJsb2dpYy1zZXJ2ZXJzL3JlcXVlc3QtYW5kLXJlcG9zbnNlLW9uLWJ1cnAtc3VpdGUucG5n?s=6e5101f7fb2f456b70daa47177ecb489"/></p><h2 id="how-to-mitigate-cve-2022-21371-in-oracle-weblogic-servers">如何缓解 Oracle WebLogic 服务器中的 CVE-2022-21371</h2><p>我们建议尽快将易受攻击的 WebLogic 服务器升级到最新版本，并确保遵循来自<a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.oracle.com/security-alerts/cpujan2022.html"> Oracle 关键补丁更新顾问</a>的指导方针，以确保系统可以安全使用，并且攻击面仍在控制之下。</p><p>我们会很快听说 Oracle WebLogic Servers 中其他可利用的漏洞吗？</p><p>时间会证明一切。</p><p>作为攻击性安全专家，我们可以专注于帮助组织实施缓解措施，并将其集成到业务优先级中。通过这种方式，他们可以限制恶意行为者试图利用此类漏洞的机会，并控制攻击面。</p><p>请相信我们，我们会以有益的测试指南的形式继续分享我们的研究，提高您的道德黑客技能。</p>

                

                
              
            
          </div>
        </div>    
</body>
</html>